---
title: 三星o1o2o3项目随笔
toc: true
date: 2020-01-01 00:00:01
tags: 项目随笔
---

# (一) 项目相关

------

1. 平台

   高通 sdm439 mm-camera 架构

2. PLM 账号密码 

   登录网址（IE浏览器）：http://myproject.samsungmobile.com

   账号：junwei2

   密码：ZJWzhq1314

# (二) XTS 问题相关

------

## 2.1 CTS 测试

1. 工厂版本测试，正常版本测试只需要测试2颗摄像头，主摄和前摄，测试结果报cameraid 2, 3,4 的一律不看。

2. 如果出现测试过程中，由于某一项卡住，或者timeout 导致测试失败。有可能是没有暴露两颗摄像头给CTS. 可以参考一下修改，编译生成的库libcamera2ndk.so .push 路径：system/lib

   <details>
   <summary>暴露两颗模组给CTS</summary>

   ```c++
   //frameworks/av/camera/ndk/impl/ACameraManager.cpp
   camera_status_t
   ACameraManager::getCameraIdList(ACameraIdList** cameraIdList) {
       Mutex::Autolock _l(mLock);
   
       std::vector<String8> idList;
       CameraManagerGlobal::getInstance().getCameraIdList(&idList);
   
       int numCameras = idList.size();
       ACameraIdList *out = new ACameraIdList;
       if (!out) {
           ALOGE("Allocate memory for ACameraIdList failed!");
           return ACAMERA_ERROR_NOT_ENOUGH_MEMORY;
       }
       //这里强制暴露2颗模组给 CTS
       //Expose two cameras fot CTS tests begin by zangyufei@huaqin.com
       if(numCameras > 2)
       {
           numCameras = 2;
           ALOGE("Expose two cameras numCameras %d",numCameras);
       }
       //Expose two cameras fot CTS tests end by zangyufei@huaqin.com
       out->numCameras = numCameras;
       out->cameraIds = new const char*[numCameras];
       if (!out->cameraIds) {
           ALOGE("Allocate memory for ACameraIdList failed!");
           deleteCameraIdList(out);
           return ACAMERA_ERROR_NOT_ENOUGH_MEMORY;
       }
       for (int i = 0; i < numCameras; i++) {
           const char* src = idList[i].string();
           size_t dstSize = strlen(src) + 1;
           char* dst = new char[dstSize];
           if (!dst) {
               ALOGE("Allocate memory for ACameraIdList failed!");
               deleteCameraIdList(out);
               return ACAMERA_ERROR_NOT_ENOUGH_MEMORY;
           }
           strlcpy(dst, src, dstSize);
           out->cameraIds[i] = dst;
       }
       *cameraIdList = out;
       return ACAMERA_OK;
   }
   ```

   </details>

# (三) Golden Bin 相关

------

## 3.1 golden.bin 导入

1. 在导入golden.bin的时候发现路径找不到

   ![golden.bin](%E4%B8%89%E6%98%9Fo1o2o3%E9%A1%B9%E7%9B%AE%E9%9A%8F%E7%AC%94/image-20210106105826257.png)

2. 解决方法(通过opengrok搜索关键字 dualcali_golden_xx.bin(参考提交))

   ![路径](%E4%B8%89%E6%98%9Fo1o2o3%E9%A1%B9%E7%9B%AE%E9%9A%8F%E7%AC%94/image-20210106110327047.png)

3. 配置golden.bin的相关xml

   通过以下配置发现golden.bin路径并非我们存放的位置

   ```xml
   path:  factory/config/HS50/sensor_config.xml
   <Item rear_camera="hi1336_hs50_hlt : HQ20207953000"  sub_camera= "gc02m1_hs50_ly : HQ20207879000" filepath="/vendor/lib/dualcali_golden_22.bin"></Item>
   <Item rear_camera="hi1336_hs50_hlt : HQ20207953000"  sub_camera= "gc2375h_hs50_sjc : HQ20200002SJC" filepath="/vendor/lib/dualcali_golden_23.bin"></Item>
   <Item rear_camera="hi1336_hs50_hlt : HQ20207953000"  sub_camera= "gc2375h_hs50_cxt : HQ20207875000" filepath="/vendor/lib/dualcali_golden_24.bin"></Item>
   ```

4. open grok 搜关键字 **LIB_GOLDEN_BASE** 或者 **libGoldenArc** (上面的路径)

   会发现有个copy的过程

   ![golden文件拷贝](%E4%B8%89%E6%98%9Fo1o2o3%E9%A1%B9%E7%9B%AE%E9%9A%8F%E7%AC%94/image-20210106114048797.png)

